import{_ as L,o as F,b as D,c as G,e as a,w as t,r as n,i as u,J as H,I as Q,f as W,l as r,d as S,u as X,U as Y,P as d,K as Z}from"./index-Bc-dwE5O.js";import{s as f}from"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const ee={class:"campus-manage"},ae={class:"card-header"},te={__name:"CampusManage",setup(le){const g=u(!1),b=u(!1),k=u([]),y=u(1),V=u(10),w=u(0),i=u(!1),_=u(!1),x=u(null),s=Z({id:null,name:"",address:"",status:1}),$={name:[{required:!0,message:"请输入校区名称",trigger:"blur"}]},m=async()=>{g.value=!0;try{const o=await f.get("/admin/campus/list",{params:{pageNum:y.value,pageSize:V.value}});k.value=o.data.records||[],w.value=o.data.total||0}catch(o){console.error("获取校区列表失败:",o)}finally{g.value=!1}},N=()=>{_.value=!1,Object.assign(s,{id:null,name:"",address:"",status:1}),i.value=!0},B=o=>{_.value=!0,Object.assign(s,o),i.value=!0},E=async()=>{await x.value.validate(),b.value=!0;try{_.value?(await f.put("/admin/campus/update",s),d.success("更新成功")):(await f.post("/admin/campus/add",s),d.success("添加成功")),i.value=!1,m()}catch(o){d.error(o.message||"操作失败")}finally{b.value=!1}},M=async o=>{try{await f.delete(`/admin/campus/${o}`),d.success("删除成功"),m()}catch{d.error("删除失败")}},h=async o=>{try{await f.put(`/admin/campus/status/${o.id}`,null,{params:{status:o.status}}),d.success("状态更新成功")}catch{o.status=o.status===1?0:1,d.error("状态更新失败")}};return F(()=>{m()}),(o,e)=>{const j=n("el-icon"),c=n("el-button"),p=n("el-table-column"),I=n("el-switch"),O=n("el-popconfirm"),P=n("el-table"),R=n("el-pagination"),T=n("el-card"),U=n("el-input"),C=n("el-form-item"),z=n("el-radio"),q=n("el-radio-group"),A=n("el-form"),J=n("el-dialog"),K=H("loading");return D(),G("div",ee,[a(T,null,{header:t(()=>[S("div",ae,[e[8]||(e[8]=S("span",null,"校区管理",-1)),a(c,{type:"primary",onClick:N},{default:t(()=>[a(j,null,{default:t(()=>[a(X(Y))]),_:1}),e[7]||(e[7]=r(" 添加校区 ",-1))]),_:1})])]),default:t(()=>[Q((D(),W(P,{data:k.value,stripe:""},{default:t(()=>[a(p,{prop:"id",label:"ID",width:"80"}),a(p,{prop:"name",label:"校区名称"}),a(p,{prop:"address",label:"地址"}),a(p,{prop:"status",label:"状态",width:"100"},{default:t(({row:l})=>[a(I,{modelValue:l.status,"onUpdate:modelValue":v=>l.status=v,"active-value":1,"inactive-value":0,onChange:v=>h(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(p,{prop:"createTime",label:"创建时间",width:"180"}),a(p,{label:"操作",width:"150",fixed:"right"},{default:t(({row:l})=>[a(c,{type:"primary",link:"",onClick:v=>B(l)},{default:t(()=>[...e[9]||(e[9]=[r("编辑",-1)])]),_:1},8,["onClick"]),a(O,{title:"确定删除该校区吗？",onConfirm:v=>M(l.id)},{reference:t(()=>[a(c,{type:"danger",link:""},{default:t(()=>[...e[10]||(e[10]=[r("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[K,g.value]]),a(R,{"current-page":y.value,"onUpdate:currentPage":e[0]||(e[0]=l=>y.value=l),"page-size":V.value,"onUpdate:pageSize":e[1]||(e[1]=l=>V.value=l),total:w.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:m,onCurrentChange:m,style:{"margin-top":"16px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),a(J,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=l=>i.value=l),title:_.value?"编辑校区":"添加校区",width:"500px"},{footer:t(()=>[a(c,{onClick:e[5]||(e[5]=l=>i.value=!1)},{default:t(()=>[...e[13]||(e[13]=[r("取消",-1)])]),_:1}),a(c,{type:"primary",onClick:E,loading:b.value},{default:t(()=>[...e[14]||(e[14]=[r("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(A,{model:s,rules:$,ref_key:"formRef",ref:x,"label-width":"80px"},{default:t(()=>[a(C,{label:"校区名称",prop:"name"},{default:t(()=>[a(U,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=l=>s.name=l),placeholder:"请输入校区名称"},null,8,["modelValue"])]),_:1}),a(C,{label:"地址",prop:"address"},{default:t(()=>[a(U,{modelValue:s.address,"onUpdate:modelValue":e[3]||(e[3]=l=>s.address=l),placeholder:"请输入校区地址"},null,8,["modelValue"])]),_:1}),a(C,{label:"状态",prop:"status"},{default:t(()=>[a(q,{modelValue:s.status,"onUpdate:modelValue":e[4]||(e[4]=l=>s.status=l)},{default:t(()=>[a(z,{label:1},{default:t(()=>[...e[11]||(e[11]=[r("启用",-1)])]),_:1}),a(z,{label:0},{default:t(()=>[...e[12]||(e[12]=[r("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ue=L(te,[["__scopeId","data-v-8f0ea435"]]);export{ue as default};
