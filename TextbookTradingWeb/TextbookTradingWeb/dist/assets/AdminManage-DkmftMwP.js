import{H as J,I as K,J as O,K as H,L as P,M as Z}from"./admin-B7OQe_Oy.js";import{_ as G,o as Q,b as c,c as A,e as l,w as t,r as n,i,J as W,I as X,f as V,l as r,d as x,g as Y,F as ee,B as le,P as f,Z as ae,K as te}from"./index-Bc-dwE5O.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const se={class:"admin-manage"},oe={class:"card-header"},ne={__name:"AdminManage",setup(de){const g=i(!1),k=i([]),u=i(!1),b=i(""),y=i(null),C=i([]),o=te({id:null,username:"",nickname:"",password:"",roleId:null,status:1}),U={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}]},v=async()=>{g.value=!0;try{const s=await J({pageNum:1,pageSize:100});k.value=s.data.records}catch{}finally{g.value=!1}},N=async()=>{try{const s=await K();C.value=s.data}catch{}},h=()=>{b.value="新增管理员",Object.assign(o,{id:null,username:"",nickname:"",password:"",roleId:null,status:1}),u.value=!0},B=s=>{b.value="编辑管理员",Object.assign(o,{id:s.id,username:s.username,nickname:s.nickname,password:"",roleId:s.roleId,status:s.status}),u.value=!0},M=s=>{ae.confirm("确定要删除该管理员吗？","提示",{type:"warning"}).then(async()=>{await H(s.id),f.success("删除成功"),v()})},L=async s=>{try{await O(s.id,s.status),f.success("状态已更新")}catch{s.status=s.status===1?0:1}},q=()=>{y.value.validate(async s=>{if(s)try{o.id?(await P(o),f.success("更新成功")):(await Z(o),f.success("新增成功")),u.value=!1,v()}catch{}})};return Q(()=>{v(),N()}),(s,e)=>{const m=n("el-button"),d=n("el-table-column"),D=n("el-switch"),E=n("el-table"),R=n("el-card"),w=n("el-input"),p=n("el-form-item"),$=n("el-option"),z=n("el-select"),I=n("el-radio"),F=n("el-radio-group"),S=n("el-form"),T=n("el-dialog"),j=W("loading");return c(),A("div",se,[l(R,{shadow:"never"},{header:t(()=>[x("div",oe,[e[8]||(e[8]=x("span",null,"管理员管理",-1)),l(m,{type:"primary",onClick:h},{default:t(()=>[...e[7]||(e[7]=[r("新增管理员",-1)])]),_:1})])]),default:t(()=>[X((c(),V(E,{data:k.value},{default:t(()=>[l(d,{prop:"id",label:"ID",width:"80"}),l(d,{prop:"username",label:"用户名"}),l(d,{prop:"nickname",label:"昵称"}),l(d,{prop:"roleName",label:"所属角色"}),l(d,{label:"状态",width:"100"},{default:t(a=>[l(D,{modelValue:a.row.status,"onUpdate:modelValue":_=>a.row.status=_,"active-value":1,"inactive-value":0,onChange:_=>L(a.row),disabled:a.row.username==="admin"},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:1}),l(d,{prop:"createTime",label:"创建时间"}),l(d,{label:"操作",width:"150"},{default:t(a=>[l(m,{size:"small",link:"",onClick:_=>B(a.row)},{default:t(()=>[...e[9]||(e[9]=[r("编辑",-1)])]),_:1},8,["onClick"]),l(m,{size:"small",type:"danger",link:"",onClick:_=>M(a.row),disabled:a.row.username==="admin"},{default:t(()=>[...e[10]||(e[10]=[r("删除",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[j,g.value]])]),_:1}),l(T,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value=a),title:b.value,width:"500px"},{footer:t(()=>[l(m,{onClick:e[5]||(e[5]=a=>u.value=!1)},{default:t(()=>[...e[13]||(e[13]=[r("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:q},{default:t(()=>[...e[14]||(e[14]=[r("确定",-1)])]),_:1})]),default:t(()=>[l(S,{model:o,rules:U,ref_key:"formRef",ref:y,"label-width":"80px"},{default:t(()=>[l(p,{label:"用户名",prop:"username"},{default:t(()=>[l(w,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=a=>o.username=a),placeholder:"请输入用户名",disabled:!!o.id},null,8,["modelValue","disabled"])]),_:1}),l(p,{label:"昵称",prop:"nickname"},{default:t(()=>[l(w,{modelValue:o.nickname,"onUpdate:modelValue":e[1]||(e[1]=a=>o.nickname=a),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),o.id?Y("",!0):(c(),V(p,{key:0,label:"密码",prop:"password"},{default:t(()=>[l(w,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1})),l(p,{label:"角色",prop:"roleId"},{default:t(()=>[l(z,{modelValue:o.roleId,"onUpdate:modelValue":e[3]||(e[3]=a=>o.roleId=a),placeholder:"请选择角色",style:{width:"100%"}},{default:t(()=>[(c(!0),A(ee,null,le(C.value,a=>(c(),V($,{key:a.id,label:a.roleName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"状态"},{default:t(()=>[l(F,{modelValue:o.status,"onUpdate:modelValue":e[4]||(e[4]=a=>o.status=a)},{default:t(()=>[l(I,{label:1},{default:t(()=>[...e[11]||(e[11]=[r("正常",-1)])]),_:1}),l(I,{label:0},{default:t(()=>[...e[12]||(e[12]=[r("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},pe=G(ne,[["__scopeId","data-v-ad97506e"]]);export{pe as default};
