import{e as F,i as D}from"./admin-B7OQe_Oy.js";import{_ as R,o as J,b as y,c as S,e,w as l,r as n,i as m,J as Z,I as q,f as G,d as p,t as i,l as s,g as H,Z as K,P as x}from"./index-Bc-dwE5O.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const O={class:"textbook-audit"},Q={class:"price"},W={key:0,class:"textbook-detail"},X={class:"detail-images"},Y={class:"price"},ee={class:"original-price"},le={class:"description"},te={__name:"TextbookAudit",setup(ae){const g=m(!1),C=m([]),v=m(!1),f=m(!1),a=m(null),d=m({id:null,reason:""}),w=async()=>{g.value=!0;try{const u=await F({pageNum:1,pageSize:100,auditStatus:0});C.value=u.data.records}catch{}finally{g.value=!1}},b=async(u,t)=>{t===1?K.confirm("确定审核通过该教材吗？","提示").then(async()=>{await D({id:u.id,auditStatus:1}),x.success("已通过审核"),w()}):(d.value.id=u.id,d.value.reason="",v.value=!0)},h=async()=>{if(!d.value.reason){x.warning("请输入拒绝原因");return}try{await D({id:d.value.id,auditStatus:2,auditRemark:d.value.reason}),x.success("已拒绝审核"),v.value=!1,w()}catch{}},V=u=>{a.value=u,f.value=!0},N=u=>{f.value=!1,u===1?b(a.value,1):b(a.value,2)};return J(w),(u,t)=>{const _=n("el-table-column"),T=n("el-image"),c=n("el-button"),A=n("el-table"),z=n("el-card"),$=n("el-col"),r=n("el-descriptions-item"),I=n("el-tag"),L=n("el-descriptions"),M=n("el-row"),B=n("el-dialog"),j=n("el-input"),E=n("el-form-item"),P=n("el-form"),U=Z("loading");return y(),S("div",O,[e(z,{shadow:"never",class:"table-card"},{header:l(()=>[...t[7]||(t[7]=[p("div",{class:"card-header"},[p("span",null,"教材发布审核")],-1)])]),default:l(()=>[q((y(),G(A,{data:C.value,style:{width:"100%"}},{default:l(()=>[e(_,{prop:"id",label:"ID",width:"80"}),e(_,{label:"封面",width:"100"},{default:l(o=>[e(T,{src:o.row.cover,style:{width:"60px",height:"80px",cursor:"pointer"},fit:"cover",onClick:k=>V(o.row)},null,8,["src","onClick"])]),_:1}),e(_,{prop:"title",label:"书名","min-width":"200"}),e(_,{prop:"sellerName",label:"发布者",width:"120"}),e(_,{prop:"price",label:"售价",width:"100"},{default:l(o=>[p("span",Q,"¥"+i(o.row.price),1)]),_:1}),e(_,{prop:"createTime",label:"申请时间",width:"180"}),e(_,{label:"操作",width:"200",fixed:"right"},{default:l(o=>[e(c,{size:"small",type:"primary",link:"",onClick:k=>b(o.row,1)},{default:l(()=>[...t[8]||(t[8]=[s("通过",-1)])]),_:1},8,["onClick"]),e(c,{size:"small",type:"danger",link:"",onClick:k=>b(o.row,2)},{default:l(()=>[...t[9]||(t[9]=[s("拒绝",-1)])]),_:1},8,["onClick"]),e(c,{size:"small",link:"",onClick:k=>V(o.row)},{default:l(()=>[...t[10]||(t[10]=[s("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,g.value]])]),_:1}),e(B,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=o=>f.value=o),title:"教材详情",width:"800px"},{footer:l(()=>[e(c,{onClick:t[0]||(t[0]=o=>f.value=!1)},{default:l(()=>[...t[11]||(t[11]=[s("关闭",-1)])]),_:1}),e(c,{type:"danger",onClick:t[1]||(t[1]=o=>N(2))},{default:l(()=>[...t[12]||(t[12]=[s("拒绝",-1)])]),_:1}),e(c,{type:"primary",onClick:t[2]||(t[2]=o=>N(1))},{default:l(()=>[...t[13]||(t[13]=[s("通过",-1)])]),_:1})]),default:l(()=>[a.value?(y(),S("div",W,[e(M,{gutter:20},{default:l(()=>[e($,{span:8},{default:l(()=>[p("div",X,[e(T,{src:a.value.cover,fit:"cover",class:"main-image","preview-src-list":a.value.images||[a.value.cover]},null,8,["src","preview-src-list"])])]),_:1}),e($,{span:16},{default:l(()=>[e(L,{column:2,border:""},{default:l(()=>[e(r,{label:"书名",span:2},{default:l(()=>[p("strong",null,i(a.value.title),1)]),_:1}),e(r,{label:"作者"},{default:l(()=>[s(i(a.value.author||"-"),1)]),_:1}),e(r,{label:"出版社"},{default:l(()=>[s(i(a.value.publisher||"-"),1)]),_:1}),e(r,{label:"ISBN"},{default:l(()=>[s(i(a.value.isbn||"-"),1)]),_:1}),e(r,{label:"分类"},{default:l(()=>[s(i(a.value.categoryName||"-"),1)]),_:1}),e(r,{label:"售价"},{default:l(()=>[p("span",Y,"¥"+i(a.value.price),1)]),_:1}),e(r,{label:"原价"},{default:l(()=>[p("span",ee,"¥"+i(a.value.originalPrice),1)]),_:1}),e(r,{label:"成色"},{default:l(()=>[e(I,{type:"success"},{default:l(()=>[s(i(a.value.conditionLevel)+"成新",1)]),_:1})]),_:1}),e(r,{label:"适用课程"},{default:l(()=>[s(i(a.value.course||"-"),1)]),_:1}),e(r,{label:"发布者"},{default:l(()=>[s(i(a.value.sellerName),1)]),_:1}),e(r,{label:"联系方式"},{default:l(()=>[s(i(a.value.sellerPhone||"-"),1)]),_:1}),e(r,{label:"发布时间",span:2},{default:l(()=>[s(i(a.value.createTime),1)]),_:1}),e(r,{label:"教材描述",span:2},{default:l(()=>[p("div",le,i(a.value.description||"暂无描述"),1)]),_:1})]),_:1})]),_:1})]),_:1})])):H("",!0)]),_:1},8,["modelValue"]),e(B,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=o=>v.value=o),title:"拒绝审核",width:"400px"},{footer:l(()=>[e(c,{onClick:t[5]||(t[5]=o=>v.value=!1)},{default:l(()=>[...t[14]||(t[14]=[s("取消",-1)])]),_:1}),e(c,{type:"primary",onClick:h},{default:l(()=>[...t[15]||(t[15]=[s("确定",-1)])]),_:1})]),default:l(()=>[e(P,{model:d.value},{default:l(()=>[e(E,{label:"拒绝原因"},{default:l(()=>[e(j,{type:"textarea",modelValue:d.value.reason,"onUpdate:modelValue":t[4]||(t[4]=o=>d.value.reason=o),rows:"4",placeholder:"请输入拒绝原因，将通知发布者"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},re=R(te,[["__scopeId","data-v-b7eb9ec3"]]);export{re as default};
