import{_ as R,o as Y,I as C,b as a,c as i,d as e,e as g,l as h,t as l,f as u,w as d,g as r,J as j,i as v,r as c,a5 as z,O as F,L as M,j as $,F as A,B as q}from"./index-Bc-dwE5O.js";import{g as E}from"./user-nO6ITqrd.js";import{g as J}from"./textbook-Pf6eG0Sa.js";import{u as O}from"./user-BS79HK15.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const G={class:"container user-profile-page"},H={key:0,class:"profile-card"},K={class:"profile-header"},Q={class:"profile-info"},W={class:"profile-name"},X={key:0,class:"profile-school"},Z={class:"profile-time"},ee={key:0,class:"profile-actions"},te={class:"profile-stats"},se={class:"stat-item"},oe={class:"stat-item"},ae={class:"stat-item"},le={class:"stat-item"},re={key:1,class:"textbook-section"},ne=["src"],ie={class:"book-info"},ce={class:"book-title"},ue={class:"book-price"},de={class:"price"},pe={key:0,class:"original-price"},_e="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",ve={__name:"UserProfile",setup(me){const m=M(),k=$(),y=O(),p=v(!1),_=v(!1),t=v(null),f=v([]),w=F(()=>{var s;return t.value&&((s=y.userInfo)==null?void 0:s.id)===t.value.id}),I=s=>s?z(s).format("YYYY-MM-DD"):"",T=async()=>{p.value=!0;try{const s=await E(m.params.id);t.value=s.data}catch(s){console.error("获取用户信息失败:",s)}finally{p.value=!1}},B=async()=>{_.value=!0;try{const s=await J({userId:m.params.id,pageNum:1,pageSize:12,status:1});f.value=s.data.records||[]}catch(s){console.error("获取教材列表失败:",s)}finally{_.value=!1}},D=()=>{if(!y.isLogin){k.push("/login");return}k.push({path:"/chat",query:{userId:m.params.id}})};return Y(()=>{T(),B()}),(s,o)=>{const L=c("el-avatar"),N=c("el-tag"),P=c("el-button"),S=c("el-card"),U=c("el-col"),V=c("el-row"),b=c("el-empty"),x=j("loading");return C((a(),i("div",G,[t.value?(a(),i("div",H,[e("div",K,[g(L,{size:80,src:t.value.avatar||_e},null,8,["src"]),e("div",Q,[e("h2",W,[h(l(t.value.nickname)+" ",1),t.value.isVerified?(a(),u(N,{key:0,type:"success",size:"small"},{default:d(()=>[...o[0]||(o[0]=[h("已认证",-1)])]),_:1})):r("",!0)]),t.value.school?(a(),i("p",X,l(t.value.school)+" · "+l(t.value.college)+" · "+l(t.value.major),1)):r("",!0),e("p",Z,"注册于 "+l(I(t.value.createTime)),1)]),w.value?r("",!0):(a(),i("div",ee,[g(P,{type:"primary",onClick:D},{default:d(()=>[...o[1]||(o[1]=[h("发消息",-1)])]),_:1})]))]),e("div",te,[e("div",se,[e("strong",null,l(t.value.textbookCount||0),1),o[2]||(o[2]=e("span",null,"发布教材",-1))]),e("div",oe,[e("strong",null,l(t.value.orderCount||0),1),o[3]||(o[3]=e("span",null,"成交订单",-1))]),e("div",ae,[e("strong",null,l(t.value.goodRate?(t.value.goodRate*100).toFixed(0)+"%":"暂无"),1),o[4]||(o[4]=e("span",null,"好评率",-1))]),e("div",le,[e("strong",null,l(t.value.favoriteCount||0),1),o[5]||(o[5]=e("span",null,"收藏",-1))])])])):r("",!0),t.value?(a(),i("div",re,[o[6]||(o[6]=e("h3",null,"TA发布的教材",-1)),C((a(),u(V,{gutter:20},{default:d(()=>[(a(!0),i(A,null,q(f.value,n=>(a(),u(U,{span:6,key:n.id},{default:d(()=>[g(S,{shadow:"hover",class:"book-card",onClick:fe=>s.$router.push(`/textbook/${n.id}`)},{default:d(()=>[e("img",{src:n.coverImage||"/images/default-book.png",class:"book-cover"},null,8,ne),e("div",ie,[e("div",ce,l(n.title),1),e("div",ue,[e("span",de,"¥"+l(n.price),1),n.originalPrice?(a(),i("span",pe,"¥"+l(n.originalPrice),1)):r("",!0)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),[[x,_.value]]),!_.value&&f.value.length===0?(a(),u(b,{key:0,description:"暂未发布教材"})):r("",!0)])):r("",!0),!p.value&&!t.value?(a(),u(b,{key:2,description:"用户不存在"})):r("",!0)])),[[x,p.value]])}}},Ce=R(ve,[["__scopeId","data-v-f989152c"]]);export{Ce as default};
