import{_ as J,o as O,b as a,c,d as t,l as v,e as n,w as l,h as Q,A as W,F as k,B as y,g as D,i as _,r as d,j as X,f as C,C as Y,t as i,u as w,D as Z,n as ee,z as te,E,G as se}from"./index-Bc-dwE5O.js";import{g as oe}from"./textbook-Pf6eG0Sa.js";import{s as V}from"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const ae={class:"home"},ne={class:"hero"},le={class:"container hero-inner"},ie={class:"hero-text"},ce={class:"hero-search"},re={class:"hero-banner"},de=["src","alt"],ue={key:1,class:"banner-placeholder"},ve={key:0,class:"notice-float"},_e={class:"container notice-inner"},fe={class:"notice-icon"},pe={class:"notice-scroll"},he=["onClick"],me={class:"section-categories"},be={class:"container"},ge={class:"category-grid"},ke=["onClick"],ye={class:"cat-card__icon"},Ce={class:"cat-card__body"},we={class:"cat-card__name"},Ve={class:"cat-card__count"},xe={class:"cat-card__arrow"},Ne={class:"section-latest"},Be={class:"container"},Se={class:"section-head"},ze=["onClick"],De={class:"book-cover-wrap"},Fe=["src"],Ue={class:"book-condition"},$e={class:"book-body"},Ee={class:"book-title"},Le={class:"book-price-row"},Me={class:"book-price"},Te={class:"book-original"},He={class:"book-meta"},Ie={key:0,class:"notice-detail"},Ke={class:"notice-title"},qe={class:"notice-time"},Ae={class:"notice-content"},Re={__name:"Home",setup(je){const x=X(),N=_([]),B=_([]),S=_([]),m=_([]),b=_(!1),p=_(null),g=_(""),F=()=>{g.value.trim()&&x.push({path:"/textbooks",query:{keyword:g.value.trim()}})},L=async()=>{try{const o=await V.get("/banner/list");o.data&&o.data.length>0?N.value=o.data.filter(e=>e.status===1):U()}catch(o){console.error("Failed to fetch banners:",o),U()}},U=()=>{N.value=[{id:1,title:"开学季特惠活动",imageUrl:"/images/books/banners/banner1.png",color:"#e8f3ff"},{id:2,title:"让闲置教材流动起来",imageUrl:"/images/books/banners/banner2.png",color:"#f0f9eb"},{id:3,title:"校园二手交易平台",imageUrl:"/images/books/banners/banner3.png",color:"#f4f4f5"}]},M=async()=>{try{const o=await V.get("/category/list");if(o.data&&o.data.length>0){const e=o.data.filter(r=>!r.parentId||r.parentId===0);try{const r=await V.get("/category/stats"),f={};r.data&&r.data.forEach(u=>{f[u.name]=u.value}),e.forEach(u=>{u.count=f[u.name]||0})}catch{e.forEach(f=>{f.count=0})}B.value=e}else $()}catch(o){console.error("Failed to fetch categories:",o),$()}},$=()=>{B.value=[{id:1,name:"计算机类",icon:"Monitor"},{id:2,name:"经济管理",icon:"DataLine"},{id:3,name:"文学艺术",icon:"Edit"},{id:4,name:"理工科",icon:"Cpu"},{id:5,name:"医药卫生",icon:"FirstAidKit"},{id:6,name:"外语考试",icon:"School"}]},T=async()=>{var o;try{const e=await oe({pageSize:8,status:1});S.value=((o=e.data)==null?void 0:o.records)||[]}catch(e){console.error("Failed to fetch latest books:",e),S.value=[]}},H=async()=>{var o;try{const e=await V.get("/notice/list",{params:{pageNum:1,pageSize:3}});m.value=((o=e.data)==null?void 0:o.records)||[]}catch(e){console.error("Failed to fetch notices:",e),m.value=[]}},I=o=>o?new Date(o).toLocaleDateString("zh-CN"):"",K=o=>{p.value=o,b.value=!0},q=o=>{x.push({path:"/textbooks",query:{categoryId:o}})},A=o=>{x.push(`/textbook/${o}`)};return O(()=>{L(),M(),T(),H()}),(o,e)=>{const r=d("el-button"),f=d("el-input"),u=d("el-carousel-item"),R=d("el-carousel"),h=d("el-icon"),j=d("el-col"),G=d("el-row"),P=d("el-dialog");return a(),c("div",ae,[t("section",ne,[e[9]||(e[9]=t("div",{class:"hero-bg"},[t("div",{class:"hero-orb hero-orb--1"}),t("div",{class:"hero-orb hero-orb--2"}),t("div",{class:"hero-orb hero-orb--3"})],-1)),t("div",le,[t("div",ie,[e[5]||(e[5]=t("h1",{class:"hero-title"},[v("让闲置教材"),t("span",{class:"highlight"},"流动"),v("起来")],-1)),e[6]||(e[6]=t("p",{class:"hero-desc"},"校园二手教材交易平台 · 省钱环保从这里开始",-1)),t("div",ce,[n(f,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),placeholder:"搜索教材名称、作者、课程...",size:"large",clearable:"",onKeyup:Q(F,["enter"])},{append:l(()=>[n(r,{type:"primary",onClick:F},{default:l(()=>[...e[4]||(e[4]=[v("搜 索",-1)])]),_:1})]),_:1},8,["modelValue"])]),e[7]||(e[7]=W('<div class="hero-stats" data-v-68efcb4f><div class="stat" data-v-68efcb4f><strong data-v-68efcb4f>5000+</strong><span data-v-68efcb4f>在售教材</span></div><div class="stat-divider" data-v-68efcb4f></div><div class="stat" data-v-68efcb4f><strong data-v-68efcb4f>3200+</strong><span data-v-68efcb4f>注册用户</span></div><div class="stat-divider" data-v-68efcb4f></div><div class="stat" data-v-68efcb4f><strong data-v-68efcb4f>8600+</strong><span data-v-68efcb4f>成功交易</span></div></div>',1))]),t("div",re,[n(R,{class:"banner",interval:5e3,arrow:"hover","indicator-position":"outside"},{default:l(()=>[(a(!0),c(k,null,y(N.value,s=>(a(),C(u,{key:s.id},{default:l(()=>[t("div",{class:"banner-item",style:Y({background:s.color?s.color:"#1e2432"})},[s.imageUrl?(a(),c("img",{key:0,src:s.imageUrl,alt:s.title,class:"banner-img"},null,8,de)):(a(),c("div",ue,i(s.title),1))],4)]),_:2},1024))),128))]),_:1})])]),m.value.length?(a(),c("div",ve,[t("div",_e,[t("div",fe,[n(h,null,{default:l(()=>[n(w(Z))]),_:1}),e[8]||(e[8]=v(" 公告",-1))]),t("div",pe,[(a(!0),c(k,null,y(m.value,s=>(a(),c("span",{key:s.id,class:"notice-item",onClick:z=>K(s)},i(s.title),9,he))),128))])])])):D("",!0)]),t("section",me,[e[12]||(e[12]=t("div",{class:"cat-deco cat-deco--ring"},null,-1)),e[13]||(e[13]=t("div",{class:"cat-deco cat-deco--dots"},null,-1)),t("div",be,[e[11]||(e[11]=t("div",{class:"section-head"},[t("h2",null,"教材分类"),t("p",null,"快速找到你需要的课程教材")],-1)),t("div",ge,[(a(!0),c(k,null,y(B.value,(s,z)=>(a(),c("div",{key:s.id,class:ee(["cat-card","cat-card--"+(z%6+1)]),onClick:Ge=>q(s.id)},[e[10]||(e[10]=t("div",{class:"cat-card__deco"},null,-1)),t("div",ye,[s.icon?(a(),C(h,{key:0},{default:l(()=>[(a(),C(te(s.icon)))]),_:2},1024)):D("",!0)]),t("div",Ce,[t("span",we,i(s.name),1),t("span",Ve,i(s.count||0)+"本教材",1)]),t("div",xe,[n(h,null,{default:l(()=>[n(w(E))]),_:1})])],10,ke))),128))])])]),t("section",Ne,[e[16]||(e[16]=t("div",{class:"latest-deco latest-deco--circle"},null,-1)),e[17]||(e[17]=t("div",{class:"latest-deco latest-deco--grid"},null,-1)),t("div",Be,[t("div",Se,[e[15]||(e[15]=t("h2",null,"最新发布",-1)),n(r,{type:"primary",plain:"",round:"",onClick:e[1]||(e[1]=s=>o.$router.push("/textbooks"))},{default:l(()=>[e[14]||(e[14]=v("查看全部 ",-1)),n(h,null,{default:l(()=>[n(w(E))]),_:1})]),_:1})]),n(G,{gutter:24},{default:l(()=>[(a(!0),c(k,null,y(S.value,s=>(a(),C(j,{span:6,key:s.id},{default:l(()=>[t("div",{class:"book-card",onClick:z=>A(s.id)},[t("div",De,[t("img",{src:s.cover,class:"book-cover"},null,8,Fe),t("div",Ue,i(s.conditionLevel)+"成新",1)]),t("div",$e,[t("h3",Ee,i(s.title),1),t("div",Le,[t("span",Me,"¥"+i(s.price),1),t("span",Te,"¥"+i(s.originalPrice),1)]),t("div",He,[t("span",null,[n(h,null,{default:l(()=>[n(w(se))]),_:1}),v(" "+i(s.viewCount),1)])])])],8,ze)]),_:2},1024))),128))]),_:1})])]),n(P,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),title:"公告详情",width:"600px"},{footer:l(()=>[n(r,{onClick:e[2]||(e[2]=s=>b.value=!1)},{default:l(()=>[...e[18]||(e[18]=[v("关闭",-1)])]),_:1})]),default:l(()=>[p.value?(a(),c("div",Ie,[t("h3",Ke,i(p.value.title),1),t("div",qe,i(I(p.value.createTime)),1),t("div",Ae,i(p.value.content),1)])):D("",!0)]),_:1},8,["modelValue"])])}}},We=J(Re,[["__scopeId","data-v-68efcb4f"]]);export{We as default};
