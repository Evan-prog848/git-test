import{_ as _e,o as ye,b as p,c as I,e as l,w as t,r,i,K as S,J as be,F as $,B as L,f as k,h as ee,l as u,I as le,t as ae,d as N,u as te,U as oe,P as v}from"./index-Bc-dwE5O.js";import{s as g}from"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const Ve={class:"course-manage"},we={class:"card-header"},je={class:"card-header"},ke={__name:"CourseManage",setup(Ce){const E=i([]),R=i(!1),U=i([]),C=S({campusId:"",keyword:""}),b=i(!1),x=i(!1),K=i(null),n=S({id:null,campusId:"",name:"",college:"",status:1}),re={campusId:[{required:!0,message:"请选择校区",trigger:"change"}],name:[{required:!0,message:"请输入专业名称",trigger:"blur"}]},B=i(!1),O=i([]),A=i(0),f=S({majorId:"",keyword:"",pageNum:1,pageSize:10}),V=i(!1),F=i(!1),P=i(null),s=S({id:null,majorId:"",code:"",name:"",semester:"",status:1}),ue={majorId:[{required:!0,message:"请选择专业",trigger:"change"}],name:[{required:!0,message:"请输入课程名称",trigger:"blur"}]},se=async()=>{try{const o=await g.get("/campus/list");E.value=o.data||[]}catch(o){console.error("获取校区列表失败:",o)}},w=async()=>{R.value=!0;try{const o=await g.get("/admin/course/major/list",{params:{...C,pageNum:1,pageSize:100}});U.value=o.data.records||[]}catch(o){console.error("获取专业列表失败:",o)}finally{R.value=!1}},_=async()=>{B.value=!0;try{const o=await g.get("/admin/course/list",{params:f});O.value=o.data.records||[],A.value=o.data.total||0}catch(o){console.error("获取课程列表失败:",o)}finally{B.value=!1}},ne=()=>{x.value=!1,Object.assign(n,{id:null,campusId:"",name:"",college:"",status:1}),b.value=!0},de=o=>{x.value=!0,Object.assign(n,o),b.value=!0},ie=async()=>{await K.value.validate();try{x.value?await g.put("/admin/course/major/update",n):await g.post("/admin/course/major/add",n),v.success("操作成功"),b.value=!1,w()}catch(o){v.error(o.message||"操作失败")}},me=async o=>{try{await g.delete(`/admin/course/major/${o}`),v.success("删除成功"),w()}catch{v.error("删除失败")}},pe=()=>{F.value=!1,Object.assign(s,{id:null,majorId:"",code:"",name:"",semester:"",status:1}),V.value=!0},fe=o=>{F.value=!0,Object.assign(s,o),V.value=!0},ce=async()=>{await P.value.validate();try{F.value?await g.put("/admin/course/update",s):await g.post("/admin/course/add",s),v.success("操作成功"),V.value=!1,_()}catch(o){v.error(o.message||"操作失败")}},ge=async o=>{try{await g.delete(`/admin/course/${o}`),v.success("删除成功"),_()}catch{v.error("删除失败")}};return ye(()=>{se(),w(),_()}),(o,e)=>{const T=r("el-icon"),d=r("el-button"),M=r("el-option"),z=r("el-select"),j=r("el-col"),y=r("el-input"),J=r("el-row"),m=r("el-table-column"),G=r("el-tag"),H=r("el-popconfirm"),Q=r("el-table"),W=r("el-card"),ve=r("el-pagination"),c=r("el-form-item"),D=r("el-radio"),X=r("el-radio-group"),Y=r("el-form"),Z=r("el-dialog"),h=be("loading");return p(),I("div",Ve,[l(W,{style:{"margin-bottom":"20px"}},{header:t(()=>[N("div",we,[e[20]||(e[20]=N("span",null,"专业管理",-1)),l(d,{type:"primary",size:"small",onClick:ne},{default:t(()=>[l(T,null,{default:t(()=>[l(te(oe))]),_:1}),e[19]||(e[19]=u(" 添加专业 ",-1))]),_:1})])]),default:t(()=>[l(J,{gutter:16,style:{"margin-bottom":"16px"}},{default:t(()=>[l(j,{span:6},{default:t(()=>[l(z,{modelValue:C.campusId,"onUpdate:modelValue":e[0]||(e[0]=a=>C.campusId=a),placeholder:"选择校区",clearable:"",onChange:w},{default:t(()=>[(p(!0),I($,null,L(E.value,a=>(p(),k(M,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(j,{span:6},{default:t(()=>[l(y,{modelValue:C.keyword,"onUpdate:modelValue":e[1]||(e[1]=a=>C.keyword=a),placeholder:"搜索专业",clearable:"",onKeyup:ee(w,["enter"])},null,8,["modelValue"])]),_:1}),l(j,{span:4},{default:t(()=>[l(d,{type:"primary",onClick:w},{default:t(()=>[...e[21]||(e[21]=[u("搜索",-1)])]),_:1})]),_:1})]),_:1}),le((p(),k(Q,{data:U.value,stripe:"","max-height":"300"},{default:t(()=>[l(m,{prop:"id",label:"ID",width:"80"}),l(m,{prop:"name",label:"专业名称"}),l(m,{prop:"college",label:"所属学院"}),l(m,{prop:"status",label:"状态",width:"80"},{default:t(({row:a})=>[l(G,{type:a.status===1?"success":"info"},{default:t(()=>[u(ae(a.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(m,{label:"操作",width:"150"},{default:t(({row:a})=>[l(d,{type:"primary",link:"",onClick:q=>de(a)},{default:t(()=>[...e[22]||(e[22]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(H,{title:"确定删除该专业吗？",onConfirm:q=>me(a.id)},{reference:t(()=>[l(d,{type:"danger",link:""},{default:t(()=>[...e[23]||(e[23]=[u("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[h,R.value]])]),_:1}),l(W,null,{header:t(()=>[N("div",je,[e[25]||(e[25]=N("span",null,"课程管理",-1)),l(d,{type:"primary",size:"small",onClick:pe},{default:t(()=>[l(T,null,{default:t(()=>[l(te(oe))]),_:1}),e[24]||(e[24]=u(" 添加课程 ",-1))]),_:1})])]),default:t(()=>[l(J,{gutter:16,style:{"margin-bottom":"16px"}},{default:t(()=>[l(j,{span:6},{default:t(()=>[l(z,{modelValue:f.majorId,"onUpdate:modelValue":e[2]||(e[2]=a=>f.majorId=a),placeholder:"选择专业",clearable:"",onChange:_},{default:t(()=>[(p(!0),I($,null,L(U.value,a=>(p(),k(M,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(j,{span:6},{default:t(()=>[l(y,{modelValue:f.keyword,"onUpdate:modelValue":e[3]||(e[3]=a=>f.keyword=a),placeholder:"搜索课程",clearable:"",onKeyup:ee(_,["enter"])},null,8,["modelValue"])]),_:1}),l(j,{span:4},{default:t(()=>[l(d,{type:"primary",onClick:_},{default:t(()=>[...e[26]||(e[26]=[u("搜索",-1)])]),_:1})]),_:1})]),_:1}),le((p(),k(Q,{data:O.value,stripe:""},{default:t(()=>[l(m,{prop:"id",label:"ID",width:"80"}),l(m,{prop:"code",label:"课程代码",width:"120"}),l(m,{prop:"name",label:"课程名称"}),l(m,{prop:"semester",label:"学期",width:"100"}),l(m,{prop:"status",label:"状态",width:"80"},{default:t(({row:a})=>[l(G,{type:a.status===1?"success":"info"},{default:t(()=>[u(ae(a.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(m,{label:"操作",width:"150"},{default:t(({row:a})=>[l(d,{type:"primary",link:"",onClick:q=>fe(a)},{default:t(()=>[...e[27]||(e[27]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(H,{title:"确定删除该课程吗？",onConfirm:q=>ge(a.id)},{reference:t(()=>[l(d,{type:"danger",link:""},{default:t(()=>[...e[28]||(e[28]=[u("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[h,B.value]]),l(ve,{"current-page":f.pageNum,"onUpdate:currentPage":e[4]||(e[4]=a=>f.pageNum=a),"page-size":f.pageSize,"onUpdate:pageSize":e[5]||(e[5]=a=>f.pageSize=a),total:A.value,layout:"total, prev, pager, next",onCurrentChange:_,style:{"margin-top":"16px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),l(Z,{modelValue:b.value,"onUpdate:modelValue":e[11]||(e[11]=a=>b.value=a),title:x.value?"编辑专业":"添加专业",width:"500px"},{footer:t(()=>[l(d,{onClick:e[10]||(e[10]=a=>b.value=!1)},{default:t(()=>[...e[31]||(e[31]=[u("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:ie},{default:t(()=>[...e[32]||(e[32]=[u("确定",-1)])]),_:1})]),default:t(()=>[l(Y,{model:n,rules:re,ref_key:"majorFormRef",ref:K,"label-width":"80px"},{default:t(()=>[l(c,{label:"校区",prop:"campusId"},{default:t(()=>[l(z,{modelValue:n.campusId,"onUpdate:modelValue":e[6]||(e[6]=a=>n.campusId=a),placeholder:"请选择校区",style:{width:"100%"}},{default:t(()=>[(p(!0),I($,null,L(E.value,a=>(p(),k(M,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"专业名称",prop:"name"},{default:t(()=>[l(y,{modelValue:n.name,"onUpdate:modelValue":e[7]||(e[7]=a=>n.name=a),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1}),l(c,{label:"所属学院",prop:"college"},{default:t(()=>[l(y,{modelValue:n.college,"onUpdate:modelValue":e[8]||(e[8]=a=>n.college=a),placeholder:"请输入所属学院"},null,8,["modelValue"])]),_:1}),l(c,{label:"状态"},{default:t(()=>[l(X,{modelValue:n.status,"onUpdate:modelValue":e[9]||(e[9]=a=>n.status=a)},{default:t(()=>[l(D,{label:1},{default:t(()=>[...e[29]||(e[29]=[u("启用",-1)])]),_:1}),l(D,{label:0},{default:t(()=>[...e[30]||(e[30]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(Z,{modelValue:V.value,"onUpdate:modelValue":e[18]||(e[18]=a=>V.value=a),title:F.value?"编辑课程":"添加课程",width:"500px"},{footer:t(()=>[l(d,{onClick:e[17]||(e[17]=a=>V.value=!1)},{default:t(()=>[...e[35]||(e[35]=[u("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:ce},{default:t(()=>[...e[36]||(e[36]=[u("确定",-1)])]),_:1})]),default:t(()=>[l(Y,{model:s,rules:ue,ref_key:"courseFormRef",ref:P,"label-width":"80px"},{default:t(()=>[l(c,{label:"所属专业",prop:"majorId"},{default:t(()=>[l(z,{modelValue:s.majorId,"onUpdate:modelValue":e[12]||(e[12]=a=>s.majorId=a),placeholder:"请选择专业",style:{width:"100%"}},{default:t(()=>[(p(!0),I($,null,L(U.value,a=>(p(),k(M,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"课程代码",prop:"code"},{default:t(()=>[l(y,{modelValue:s.code,"onUpdate:modelValue":e[13]||(e[13]=a=>s.code=a),placeholder:"请输入课程代码"},null,8,["modelValue"])]),_:1}),l(c,{label:"课程名称",prop:"name"},{default:t(()=>[l(y,{modelValue:s.name,"onUpdate:modelValue":e[14]||(e[14]=a=>s.name=a),placeholder:"请输入课程名称"},null,8,["modelValue"])]),_:1}),l(c,{label:"学期",prop:"semester"},{default:t(()=>[l(y,{modelValue:s.semester,"onUpdate:modelValue":e[15]||(e[15]=a=>s.semester=a),placeholder:"如：大一上"},null,8,["modelValue"])]),_:1}),l(c,{label:"状态"},{default:t(()=>[l(X,{modelValue:s.status,"onUpdate:modelValue":e[16]||(e[16]=a=>s.status=a)},{default:t(()=>[l(D,{label:1},{default:t(()=>[...e[33]||(e[33]=[u("启用",-1)])]),_:1}),l(D,{label:0},{default:t(()=>[...e[34]||(e[34]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Fe=_e(ke,[["__scopeId","data-v-c8732522"]]);export{Fe as default};
