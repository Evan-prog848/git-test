import{D as R,E as S,F as A,G}from"./admin-B7OQe_Oy.js";import{_ as J,o as K,b as w,c as L,e as l,w as t,r as s,i as p,J as P,I as Z,f as H,d as g,t as M,l as d,Z as Q,P as N,K as W,O as X}from"./index-Bc-dwE5O.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const Y={class:"menu-manage"},ee={class:"card-header"},le={__name:"MenuManage",setup(te){const f=p(!1),_=p([]),i=p(!1),b=p(""),V=p(null),o=W({id:null,parentId:null,menuName:"",path:"",component:"",icon:"",sort:0,status:1}),k={menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}]},h=X(()=>[{id:0,menuName:"顶级菜单",children:_.value}]),v=async()=>{f.value=!0;try{const n=await R();_.value=n.data}catch{}finally{f.value=!1}},I=()=>{b.value="新增菜单",Object.assign(o,{id:null,parentId:0,menuName:"",path:"",component:"",icon:"",sort:0,status:1}),i.value=!0},C=n=>{b.value="编辑菜单",Object.assign(o,{id:n.id,parentId:n.parentId||0,menuName:n.menuName,path:n.path,component:n.component,icon:n.icon,sort:n.sort,status:n.status}),i.value=!0},U=async()=>{if(await V.value.validate().catch(()=>!1))try{const e={...o};e.parentId===0&&(e.parentId=null),o.id?await A(e):await G(e),N.success("保存成功"),i.value=!1,v()}catch(e){console.error("Save failed:",e)}},x=n=>{Q.confirm("确定要删除该菜单及其子菜单吗？","提示",{type:"warning"}).then(async()=>{await S(n.id),N.success("删除成功"),v()})};return K(v),(n,e)=>{const m=s("el-button"),u=s("el-table-column"),B=s("el-tag"),D=s("el-table"),E=s("el-card"),O=s("el-tree-select"),r=s("el-form-item"),c=s("el-input"),T=s("el-input-number"),y=s("el-radio"),$=s("el-radio-group"),j=s("el-form"),q=s("el-dialog"),z=P("loading");return w(),L("div",Y,[l(E,{shadow:"never"},{header:t(()=>[g("div",ee,[e[10]||(e[10]=g("span",null,"菜单管理",-1)),l(m,{type:"primary",onClick:I},{default:t(()=>[...e[9]||(e[9]=[d("新增菜单",-1)])]),_:1})])]),default:t(()=>[Z((w(),H(D,{data:_.value,"row-key":"id","tree-props":{children:"children"}},{default:t(()=>[l(u,{prop:"menuName",label:"菜单名称",width:"180"}),l(u,{prop:"icon",label:"图标",width:"80"},{default:t(a=>[g("span",null,M(a.row.icon||"-"),1)]),_:1}),l(u,{prop:"path",label:"路由路径"}),l(u,{prop:"component",label:"组件路径"}),l(u,{prop:"sort",label:"排序",width:"80"}),l(u,{label:"状态",width:"100"},{default:t(a=>[l(B,{type:a.row.status===1?"success":"info"},{default:t(()=>[d(M(a.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(u,{label:"操作",width:"200"},{default:t(a=>[l(m,{size:"small",onClick:F=>C(a.row)},{default:t(()=>[...e[11]||(e[11]=[d("编辑",-1)])]),_:1},8,["onClick"]),l(m,{size:"small",type:"danger",onClick:F=>x(a.row)},{default:t(()=>[...e[12]||(e[12]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[z,f.value]])]),_:1}),l(q,{modelValue:i.value,"onUpdate:modelValue":e[8]||(e[8]=a=>i.value=a),title:b.value,width:"550px"},{footer:t(()=>[l(m,{onClick:e[7]||(e[7]=a=>i.value=!1)},{default:t(()=>[...e[15]||(e[15]=[d("取消",-1)])]),_:1}),l(m,{type:"primary",onClick:U},{default:t(()=>[...e[16]||(e[16]=[d("确定",-1)])]),_:1})]),default:t(()=>[l(j,{model:o,rules:k,ref_key:"formRef",ref:V,"label-width":"100px"},{default:t(()=>[l(r,{label:"上级菜单"},{default:t(()=>[l(O,{modelValue:o.parentId,"onUpdate:modelValue":e[0]||(e[0]=a=>o.parentId=a),data:h.value,props:{label:"menuName",value:"id",children:"children"},placeholder:"选择上级菜单","check-strictly":"",clearable:"",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),l(r,{label:"菜单名称",prop:"menuName"},{default:t(()=>[l(c,{modelValue:o.menuName,"onUpdate:modelValue":e[1]||(e[1]=a=>o.menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"路由路径",prop:"path"},{default:t(()=>[l(c,{modelValue:o.path,"onUpdate:modelValue":e[2]||(e[2]=a=>o.path=a),placeholder:"请输入路由路径，如 /user"},null,8,["modelValue"])]),_:1}),l(r,{label:"组件路径"},{default:t(()=>[l(c,{modelValue:o.component,"onUpdate:modelValue":e[3]||(e[3]=a=>o.component=a),placeholder:"请输入组件路径，如 UserManage"},null,8,["modelValue"])]),_:1}),l(r,{label:"图标"},{default:t(()=>[l(c,{modelValue:o.icon,"onUpdate:modelValue":e[4]||(e[4]=a=>o.icon=a),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"排序"},{default:t(()=>[l(T,{modelValue:o.sort,"onUpdate:modelValue":e[5]||(e[5]=a=>o.sort=a),min:0},null,8,["modelValue"])]),_:1}),l(r,{label:"状态"},{default:t(()=>[l($,{modelValue:o.status,"onUpdate:modelValue":e[6]||(e[6]=a=>o.status=a)},{default:t(()=>[l(y,{label:1},{default:t(()=>[...e[13]||(e[13]=[d("启用",-1)])]),_:1}),l(y,{label:0},{default:t(()=>[...e[14]||(e[14]=[d("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},de=J(le,[["__scopeId","data-v-8f1cfb17"]]);export{de as default};
