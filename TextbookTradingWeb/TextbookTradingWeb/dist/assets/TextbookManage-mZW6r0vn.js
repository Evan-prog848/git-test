import{g as X,e as Y,f as ee,h as te}from"./admin-B7OQe_Oy.js";import{_ as le,o as ae,b as p,c as v,e,w as l,r,i as g,K as oe,J as se,F as P,B as E,f as k,l as u,I as ne,d,t as n,g as C,P as F,Z as ie}from"./index-Bc-dwE5O.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const re={class:"textbook-manage"},de={style:{color:"#f56c6c","font-weight":"bold"}},ue={class:"action-buttons"},ce={class:"pagination"},pe={key:0,class:"textbook-detail"},_e={class:"detail-header"},me={class:"detail-info"},ve={class:"author"},ge={class:"publisher"},fe={class:"price-row"},be={class:"price"},he={key:0,class:"original-price"},ye={class:"tags"},we={class:"description-section"},xe={key:0,class:"images-section"},ke={class:"image-list"},Ce={__name:"TextbookManage",setup(Ve){const V=g(!1),S=g(0),z=g([]),I=g([]),f=g(!1),o=g(null),i=oe({pageNum:1,pageSize:10,title:"",categoryId:void 0,status:void 0}),j=async()=>{try{const s=await X();I.value=s.data}catch{}},b=async()=>{V.value=!0;try{const s=await Y(i);z.value=s.data.records,S.value=s.data.total}catch{}finally{V.value=!1}},D=s=>({0:"下架",1:"在售",2:"已售"})[s],B=s=>({0:"info",1:"success",2:"warning"})[s],M=()=>{i.pageNum=1,b()},J=()=>{i.title="",i.categoryId=void 0,i.status=void 0,M()},K=async s=>{const t=s.status===0?1:0;try{await ee(s.id,t);const h=t===1?"上架":"下架";F.success(`教材已${h}`),s.status=t}catch{}},Q=s=>({1:"全新",2:"九成新",3:"八成新",4:"七成新",5:"较旧"})[s]||"未知",Z=s=>{o.value=s,f.value=!0},q=async s=>{try{await ie.confirm("确定要删除该教材吗？","提示",{type:"warning"}),await te(s.id),F.success("删除成功"),b()}catch(t){t!=="cancel"&&console.error("Delete failed:",t)}};return ae(()=>{j(),b()}),(s,t)=>{const h=r("el-input"),y=r("el-form-item"),w=r("el-option"),U=r("el-select"),_=r("el-button"),A=r("el-form"),$=r("el-card"),c=r("el-table-column"),T=r("el-image"),N=r("el-tag"),G=r("el-table"),H=r("el-pagination"),L=r("el-divider"),m=r("el-descriptions-item"),O=r("el-descriptions"),R=r("el-dialog"),W=se("loading");return p(),v("div",re,[e($,{shadow:"never",class:"search-card"},{default:l(()=>[e(A,{inline:!0,model:i},{default:l(()=>[e(y,{label:"书名"},{default:l(()=>[e(h,{modelValue:i.title,"onUpdate:modelValue":t[0]||(t[0]=a=>i.title=a),placeholder:"请输入书名",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{label:"分类"},{default:l(()=>[e(U,{modelValue:i.categoryId,"onUpdate:modelValue":t[1]||(t[1]=a=>i.categoryId=a),placeholder:"全部",clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),v(P,null,E(I.value,a=>(p(),k(w,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"状态"},{default:l(()=>[e(U,{modelValue:i.status,"onUpdate:modelValue":t[2]||(t[2]=a=>i.status=a),placeholder:"全部",clearable:"",style:{width:"120px"}},{default:l(()=>[e(w,{label:"下架",value:0}),e(w,{label:"在售",value:1}),e(w,{label:"已售",value:2})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:l(()=>[e(_,{type:"primary",onClick:M},{default:l(()=>[...t[7]||(t[7]=[u("查询",-1)])]),_:1}),e(_,{onClick:J},{default:l(()=>[...t[8]||(t[8]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e($,{shadow:"never",class:"table-card"},{default:l(()=>[ne((p(),k(G,{data:z.value,style:{width:"100%"}},{default:l(()=>[e(c,{prop:"id",label:"ID",width:"80"}),e(c,{label:"封面",width:"100"},{default:l(a=>[e(T,{src:a.row.cover,style:{width:"60px",height:"80px"},fit:"cover"},null,8,["src"])]),_:1}),e(c,{prop:"title",label:"书名","min-width":"200","show-overflow-tooltip":""}),e(c,{prop:"author",label:"作者",width:"120"}),e(c,{prop:"price",label:"售价",width:"100"},{default:l(a=>[d("span",de,"¥"+n(a.row.price),1)]),_:1}),e(c,{prop:"sellerName",label:"卖家",width:"120"}),e(c,{label:"状态",width:"100"},{default:l(a=>[e(N,{type:B(a.row.status)},{default:l(()=>[u(n(D(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"viewCount",label:"浏览量",width:"100"}),e(c,{prop:"createTime",label:"发布时间",width:"180"}),e(c,{label:"操作",width:"200",fixed:"right"},{default:l(a=>[d("div",ue,[e(_,{size:"small",link:"",type:"primary",onClick:x=>Z(a.row)},{default:l(()=>[...t[9]||(t[9]=[u("详情",-1)])]),_:1},8,["onClick"]),e(_,{size:"small",link:"",type:a.row.status===0?"success":"warning",onClick:x=>K(a.row)},{default:l(()=>[u(n(a.row.status===0?"上架":"下架"),1)]),_:2},1032,["type","onClick"]),e(_,{size:"small",link:"",type:"danger",onClick:x=>q(a.row)},{default:l(()=>[...t[10]||(t[10]=[u("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[W,V.value]]),d("div",ce,[e(H,{"current-page":i.pageNum,"onUpdate:currentPage":t[3]||(t[3]=a=>i.pageNum=a),"page-size":i.pageSize,"onUpdate:pageSize":t[4]||(t[4]=a=>i.pageSize=a),total:S.value,layout:"total, prev, pager, next, jumper",onCurrentChange:b},null,8,["current-page","page-size","total"])])]),_:1}),e(R,{modelValue:f.value,"onUpdate:modelValue":t[6]||(t[6]=a=>f.value=a),title:"教材详情",width:"700px"},{footer:l(()=>[e(_,{onClick:t[5]||(t[5]=a=>f.value=!1)},{default:l(()=>[...t[13]||(t[13]=[u("关闭",-1)])]),_:1})]),default:l(()=>[o.value?(p(),v("div",pe,[d("div",_e,[e(T,{src:o.value.cover,style:{width:"120px",height:"160px","border-radius":"8px"},fit:"cover"},null,8,["src"]),d("div",me,[d("h3",null,n(o.value.title),1),d("p",ve,"作者："+n(o.value.author||"-"),1),d("p",ge,"出版社："+n(o.value.publisher||"-"),1),d("div",fe,[d("span",be,"¥"+n(o.value.price),1),o.value.originalPrice?(p(),v("span",he,"原价：¥"+n(o.value.originalPrice),1)):C("",!0)]),d("div",ye,[e(N,{type:B(o.value.status),size:"small"},{default:l(()=>[u(n(D(o.value.status)),1)]),_:1},8,["type"]),o.value.categoryName?(p(),k(N,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:l(()=>[u(n(o.value.categoryName),1)]),_:1})):C("",!0)])])]),e(L),e(O,{column:2,border:""},{default:l(()=>[e(m,{label:"教材ID"},{default:l(()=>[u(n(o.value.id),1)]),_:1}),e(m,{label:"ISBN"},{default:l(()=>[u(n(o.value.isbn||"-"),1)]),_:1}),e(m,{label:"新旧程度"},{default:l(()=>[u(n(Q(o.value.condition)),1)]),_:1}),e(m,{label:"浏览量"},{default:l(()=>[u(n(o.value.viewCount||0),1)]),_:1}),e(m,{label:"卖家"},{default:l(()=>[u(n(o.value.sellerName||"-"),1)]),_:1}),e(m,{label:"发布时间"},{default:l(()=>[u(n(o.value.createTime),1)]),_:1})]),_:1}),e(L),d("div",we,[t[11]||(t[11]=d("h4",null,"教材描述",-1)),d("p",null,n(o.value.description||"暂无描述"),1)]),o.value.images&&o.value.images.length>0?(p(),v("div",xe,[t[12]||(t[12]=d("h4",null,"教材图片",-1)),d("div",ke,[(p(!0),v(P,null,E(o.value.images,(a,x)=>(p(),k(T,{key:x,src:a,"preview-src-list":o.value.images,style:{width:"100px",height:"100px","margin-right":"10px","border-radius":"4px"},fit:"cover"},null,8,["src","preview-src-list"]))),128))])])):C("",!0)])):C("",!0)]),_:1},8,["modelValue"])])}}},Ie=le(Ce,[["__scopeId","data-v-c91e9d7a"]]);export{Ie as default};
