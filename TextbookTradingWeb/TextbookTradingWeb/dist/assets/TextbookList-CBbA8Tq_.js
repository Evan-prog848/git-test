import{_ as R,H as A,o as O,b as i,c as u,d as r,e as t,w as l,I as W,f as _,r as n,J as X,i as p,K as Y,L as Z,F as h,B as C,l as f,t as m,u as L,G as Q,M as ee,g as te}from"./index-Bc-dwE5O.js";import{g as oe}from"./textbook-Pf6eG0Sa.js";import{g as ae}from"./admin-B7OQe_Oy.js";import{g as le}from"./common-BUf8eMW3.js";import"./request-bgZeUyhp.js";import"./auth-BBsyecEI.js";const se={class:"container textbook-list-page"},ne={class:"filter-section"},ie={class:"list-section"},de=["src"],re={class:"book-info"},ce={class:"book-title"},ue={class:"book-price"},pe={class:"price"},me={class:"original-price"},_e={class:"seller-info"},fe={class:"view-count"},ge={key:0,class:"school-tag"},ve={key:0,class:"pagination"},ye={__name:"TextbookList",setup(be){const B=Z(),y=p(!1),b=p(0),k=p([]),w=p([]),V=p([]),S=p([]),o=Y({pageNum:1,pageSize:12,categoryId:void 0,campusId:void 0,courseName:"",minCondition:void 0,orderBy:"latest",keyword:""}),U=async()=>{try{const a=await ae();w.value=a.data}catch{}},g=async()=>{y.value=!0;try{const a=await oe({...o,status:1});k.value=a.data.records,b.value=a.data.total}catch{}finally{y.value=!1}},x=()=>{o.pageNum=1,g()},T=()=>{o.categoryId=void 0,o.campusId=void 0,o.courseName="",o.minCondition=void 0,o.orderBy="latest",o.keyword="",x()},D=async()=>{try{const a=await le();a.code===200&&(V.value=a.data||[])}catch(a){console.error("加载校区列表失败:",a)}},P=()=>{o.courseId=void 0,S.value=[]},$=a=>{o.pageSize=a,g()},q=a=>{o.pageNum=a,g()};return A(()=>B.query,a=>{a.categoryId&&(o.categoryId=Number(a.categoryId)),a.keyword&&(o.keyword=a.keyword),g()},{immediate:!0}),O(()=>{U(),D()}),(a,s)=>{const d=n("el-option"),v=n("el-select"),c=n("el-form-item"),F=n("el-input"),I=n("el-button"),M=n("el-form"),N=n("el-card"),j=n("el-tag"),z=n("el-icon"),E=n("el-col"),G=n("el-row"),H=n("el-pagination"),J=n("el-empty"),K=X("loading");return i(),u("div",se,[r("div",ne,[t(N,{shadow:"never"},{default:l(()=>[t(M,{inline:!0,model:o,class:"demo-form-inline"},{default:l(()=>[t(c,{label:"校区"},{default:l(()=>[t(v,{modelValue:o.campusId,"onUpdate:modelValue":s[0]||(s[0]=e=>o.campusId=e),placeholder:"全部校区",clearable:"",style:{width:"150px"},onChange:P},{default:l(()=>[(i(!0),u(h,null,C(V.value,e=>(i(),_(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"课程"},{default:l(()=>[t(F,{modelValue:o.courseName,"onUpdate:modelValue":s[1]||(s[1]=e=>o.courseName=e),placeholder:"输入课程名称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),t(c,{label:"分类"},{default:l(()=>[t(v,{modelValue:o.categoryId,"onUpdate:modelValue":s[2]||(s[2]=e=>o.categoryId=e),placeholder:"全部",clearable:"",style:{width:"150px"}},{default:l(()=>[(i(!0),u(h,null,C(w.value,e=>(i(),_(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"新旧程度"},{default:l(()=>[t(v,{modelValue:o.minCondition,"onUpdate:modelValue":s[3]||(s[3]=e=>o.minCondition=e),placeholder:"全部",clearable:"",style:{width:"150px"}},{default:l(()=>[t(d,{label:"9成新及以上",value:9}),t(d,{label:"8成新及以上",value:8}),t(d,{label:"7成新及以上",value:7}),t(d,{label:"5成新及以上",value:5})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"排序"},{default:l(()=>[t(v,{modelValue:o.orderBy,"onUpdate:modelValue":s[4]||(s[4]=e=>o.orderBy=e),placeholder:"最新发布",style:{width:"150px"}},{default:l(()=>[t(d,{label:"最新发布",value:"latest"}),t(d,{label:"价格最低",value:"price_asc"}),t(d,{label:"价格最高",value:"price_desc"}),t(d,{label:"浏览最多",value:"views"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:l(()=>[t(I,{type:"primary",onClick:x},{default:l(()=>[...s[7]||(s[7]=[f("查询",-1)])]),_:1}),t(I,{onClick:T},{default:l(()=>[...s[8]||(s[8]=[f("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),r("div",ie,[W((i(),_(G,{gutter:20},{default:l(()=>[(i(!0),u(h,null,C(k.value,e=>(i(),_(E,{span:6,key:e.id},{default:l(()=>[t(N,{"body-style":{padding:"0px"},class:"book-card",onClick:he=>a.$router.push(`/textbook/${e.id}`)},{default:l(()=>[r("img",{src:e.cover,class:"book-cover"},null,8,de),r("div",re,[r("div",ce,m(e.title),1),r("div",ue,[r("span",pe,"¥"+m(e.price),1),r("span",me,"¥"+m(e.originalPrice),1)]),r("div",_e,[t(j,{size:"small",type:"info"},{default:l(()=>[f(m(e.conditionLevel)+"成新",1)]),_:2},1024),r("span",fe,[t(z,null,{default:l(()=>[t(L(Q))]),_:1}),f(" "+m(e.viewCount),1)])]),e.school?(i(),u("div",ge,[t(z,null,{default:l(()=>[t(L(ee))]),_:1}),f(" "+m(e.school),1)])):te("",!0)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),[[K,y.value]]),b.value>0?(i(),u("div",ve,[t(H,{"current-page":o.pageNum,"onUpdate:currentPage":s[5]||(s[5]=e=>o.pageNum=e),"page-size":o.pageSize,"onUpdate:pageSize":s[6]||(s[6]=e=>o.pageSize=e),"page-sizes":[12,24,36,48],layout:"total, sizes, prev, pager, next, jumper",total:b.value,onSizeChange:$,onCurrentChange:q},null,8,["current-page","page-size","total"])])):(i(),_(J,{key:1,description:"暂无相关教材"}))])])}}},Ne=R(ye,[["__scopeId","data-v-30d47814"]]);export{Ne as default};
